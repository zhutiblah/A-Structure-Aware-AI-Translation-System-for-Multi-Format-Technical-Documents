# LLM Document Translator Pro

## 📖 项目简介 (Introduction)

**LLM Document Translator Pro** 是一款基于大语言模型（Large Language Model）的高级文档翻译工具。旨在解决传统翻译工具无法保留文档格式的痛点，它能够在**完美保留原始文档格式**（如段落样式、字体、表格、数学公式、代码块等）的前提下，提供高质量的文档翻译服务。

## ✨ 主要功能 (Features)

*   **多格式支持**：
    *   **Word (.docx)**: 深度解析 XML 结构，保留字体、字号、颜色、高亮及段落对齐方式。
    *   **Markdown (.md)**: 智能识别 Markdown 语法，保留标题、列表、代码块和链接结构。
    *   **LaTeX (.tex)**: 专为学术论文设计，支持复杂 LaTeX 项目翻译，智能识别并保留数学公式、宏定义和引用。
*   **格式无损**: 核心优势在于“格式保留”，翻译后的文档无需繁琐的二次排版，所见即所得。
*   **并发加速**: 内置多线程并发翻译引擎，大幅提升长文档的处理速度。
*   **模型兼容**: 兼容所有支持 OpenAI 接口格式的大模型（如 GPT-4, GPT-3.5, DeepSeek, Claude 等），支持自定义 API Base URL 和 API Key。
*   **用户友好**: 提供基于 PyQt6 的现代化图形界面 (GUI)，支持文件拖拽添加、实时日志显示。

## 🚀 安装与运行 (Installation & Usage)

### 方式一：直接运行 (推荐用户)
如果您已经下载了打包好的程序：
1.  双击 `LLM_Translator.exe` 即可启动。
2.  无需安装 Python 或配置环境。

### 方式二：源码运行 (开发人员)
如果您希望从源码运行或进行二次开发：

1.  **环境准备**: 确保已安装 Python 3.8 或更高版本。
2.  **安装依赖**:
    ```bash
    pip install -r requirements_build.txt
    ```
    *(注意：可能需要根据实际运行情况补充安装 `lxml` 等其他依赖)*
3.  **启动程序**:
    ```bash
    python gui_main.py
    ```

## 📖 使用指南 (User Guide)

1.  **配置 API (API Configuration)**:
    *   **API Base**: 输入大模型服务商提供的 Base URL (例如 `https://api.openai.com/v1` 或您的私有部署地址)。
    *   **API Key**: 输入您的 API 密钥 (程序不会保存您的 Key 到任何云端，仅在本地内存中使用)。
    *   **Model**: 输入模型名称 (如 `gpt-4o-mini`, `gpt-4`)。

2.  **添加文件 (Add Files)**:
    *   点击 **"选择文件..."** 按钮浏览文件。
    *   或者直接将 `.docx`, `.md`, `.tex` 文件 **拖拽** 到文件列表区域。

3.  **翻译设置 (Settings)**:
    *   在下方的标签页中选择对应的文件类型设置。
    *   **Word 设置**: 可选择翻译方向（中->英 / 英->中），设置中英文字体映射。
    *   **LaTeX 设置**: 可选择是否翻译样式文件 (.cls/.sty)。

4.  **开始翻译 (Start)**:
    *   点击 **"开始翻译"** 按钮。
    *   程序将自动处理队列中的文件，翻译后的文件将保存在原文件同目录下，文件名带有 `_translated` 后缀。
    *   右侧日志窗口会实时显示翻译进度和状态。

## 🛠️ 打包指南 (Build)

本项目包含自动打包脚本，方便生成独立的 `.exe` 文件。

1.  确保系统已安装 Python。
2.  双击运行根目录下的 **`build_exe.bat`**。
3.  脚本将自动：
    *   创建独立的虚拟环境。
    *   安装最小必要依赖 (减小体积)。
    *   使用 PyInstaller 打包生成单文件可执行程序。
4.  打包完成后，可执行文件位于 `dist/` 目录下。

